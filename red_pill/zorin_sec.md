# なろうで公開するためのメモ

## Zorin OS 12.4Liteを入れてからの設定

### ブラウザにアドオンを追加する

- まずChromiumにAdblock→uMatrix入れる。

- 次にFirefoxにuBlock Origin→uMatrix入れる。

- さらにgufwをインストールしてオンにする。(インストール後メニューにアイコンが追加される)

広告ブロッカーの設定は一例です。他のアドオンでもかまいません。問題のある広告ブロッカーもあるので、調査してから入れるべきです。

### 画面輝度を調節する

画面輝度が明るすぎるので調整する。他にも設定や確認事項など。

- */sys/class/backlight/brightness* がない。仕方なくxrandrを使う。さくっと設定完了。

- *systemctl list-unit-files --type=service* や *service --status-all* などでsshやtelnetの停止を確認しておく。

- */var/log/ufw.log* は常にチェックする。journalctlも使う。一応aa-statusも確認しておく。(ただしauditは入ってない)

Linuxではログはたいてい */var/log/* にあります。初心者はここを見ましょう。ただし今後journalctlに移行していくと思われるので、使い方を知っておく必要があります。*aa-status* はAppArmorというセキュリティソフトのコマンドです。起動状態がenableか確認しておきましょう。

### VNCは暗号化されてない→パスワードが平文で流れる

Zorin OSとラズパイをVNC接続する場合の注意事項など。

- ラズパイとPCを接続→WAN側は遮断すること。VNC接続ではwiresharkでパスワードが丸見え。

- ssh-X使え→sshかますので問題なし。

### D-ShieldとwiresharkでLAN監視する。いずれsuricataへ移行したい

もっと簡単な方法は、ラズパイをもう一台用意してプロキシを立てればよい。SquidでもPrivoxyでもよい。プロキシのログチェックでC&Cサーバとの通信をチェックする。簡易的なIDSとして利用できる。Squidのログは見やすいのでwiresharkでパケット見るより簡単。ただラズパイだと速度は出ない。ギガビットが欲しいならラズパイ4にする必要がある。

WiFiを使う場合は暗号化キーと管理画面用パスワードの漏洩対策が必要。WEPキーだと数分で解析されてしまうのでWPA2を使う。暗号化キーは定期的に変えればいいが、管理画面用パスワードまで変えるのは面倒。そこで管理画面には必ず有線で入る。これが鉄則。管理画面は「192.168.0.1」などとHTTPなので、WEPキーを解析後はパスワードが平文で流れてしまう。管理画面に入られたら、後はやりたい放題である。有線接続ならキャプチャされない限り解析は不可能。WPA2だと解析ツールは多分ない。しかし力技なら解けるので暗号化キーの定期変更は必須。無線はセキュリティ的に弱いが、対策を組み合わせれば防御は可能。

### ファイル暗号化

OpenSSLで複数のファイルを一度に暗号化する。

#### 暗号化　

CBCかCFBを使う。テキストファイルを暗号化する場合のワンライナーは以下で。暗号化ファイル名は.encをつけるとする。

*find . -name "\*.txt" -type f | xargs -I {} openssl aes-256-cfb -e -in {} -out {}.enc -iter 10000*

#### 復号

復号したファイルは.decをつける。論文じゃないから別に「復号化」でもいいと思うが。学生さんはこだわりたいんでしょう。

*find . -name "\*.enc" -type f | xargs -I {} openssl aes-256-cfb -d -in {} -out {}.dec -iter 10000*

iterオプションは適当につけた。お好みで修正してください。
